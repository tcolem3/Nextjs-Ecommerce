(()=>{var e={};e.id=883,e.ids=[883],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},66541:e=>{"use strict";e.exports=require("@prisma/client/runtime/library")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},91645:e=>{"use strict";e.exports=require("net")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},34631:e=>{"use strict";e.exports=require("tls")},79551:e=>{"use strict";e.exports=require("url")},74075:e=>{"use strict";e.exports=require("zlib")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},69547:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,pages:()=>u,routeModule:()=>l,tree:()=>n});var s=r(70260),i=r(28203),a=r(25155),o=r.n(a),d=r(67292),c={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);r.d(t,c);let n=["",{children:["(root)",{children:["order",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,77641)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\order\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,44751)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\layout.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,19611)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,82819)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,61129)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\order\\[id]\\page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},l=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/(root)/order/[id]/page",pathname:"/order/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},19508:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"0041061ba5e3b6d0936cd61fbecddc17b8c23f81ed":()=>s.BP,"0063481ceb220ca367b0bfd81f4b7e7bb8a5412c3c":()=>a.P_,"009354b2c685f8183e27b43b6c9ba079b5e5dfbd20":()=>i.f,"4006037fbd5f93e00a275688371d306ee0c10f0e9c":()=>s.cE,"401c9b575412be014157debf32a1a1378158b2c6c3":()=>s.xu,"404125e7a6a2f0a516a9634afd9d946ea3ca503de9":()=>s.kl,"4071e420d37979b01d6488c32f7874c7e8b25f49a6":()=>a.Mr,"40d284a28645fa75db43c5e69c2454b9cbdf6b7927":()=>a.I1,"40efcb2c47378c67bb23c7193b509b4fb00045e8c7":()=>i.p,"60214fc46e351a83723c4e63b39e498fe69676b5ca":()=>s.VR,"6076f8d318fdf5837c18b232d3912ca52665d432e4":()=>s.Wd});var s=r(67185),i=r(20402),a=r(34296)},96487:()=>{},78335:()=>{},77641:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,metadata:()=>o});var s=r(62740),i=r(20402),a=r(31831);let o={title:"Order Details"},d=async e=>{let{id:t}=await e.params;return await (0,i.p)(t)||(0,a.notFound)(),(0,s.jsx)(s.Fragment,{children:"Details"})}},34296:(e,t,r)=>{"use strict";r.d(t,{I1:()=>m,Mr:()=>l,P_:()=>f});var s=r(88977);r(98063);var i=r(44512),a=r(55946),o=r(67905),d=r(21320),c=r(84976),n=r(61482),u=r(56215);let p=e=>{let t=(0,a.X4)(e.reduce((e,t)=>e+Number(t.price)*t.qty,0)),r=(0,a.X4)(t>100?0:10),s=(0,a.X4)(.15*t),i=(0,a.X4)(t+s+r);return{itemsPrice:t.toFixed(2),shippingPrice:r.toFixed(2),taxPrice:s.toFixed(2),totalPrice:i.toFixed(2)}};async function l(e){try{let t=(await i.UL()).get("sessionCartId")?.value;if(!t)throw Error("Cart session not found");let r=await (0,o.j2)(),s=r?.user?.id?r.user.id:void 0,a=await f(),u=c.HS.parse(e),l=await d.z.product.findFirst({where:{id:u.productId}});if(!l)throw Error("Product not found");if(a){let e=a.items.find(e=>e.productId===u.productId);if(e){if(l.stock<e.qty+1)throw Error("Not enough stock");a.items.find(e=>e.productId===u.productId).qty=e.qty+1}else{if(l.stock<1)throw Error("Not enough stock");a.items.push(u)}return await d.z.cart.update({where:{id:a.id},data:{items:a.items,...p(a.items)}}),(0,n.revalidatePath)(`/product/${l.slug}`),{success:!0,message:`${l.name} ${e?"updated in":"added to"} cart`}}{let e=c.rZ.parse({userId:s,items:[u],sessionCartId:t,...p([u])});return await d.z.cart.create({data:e}),(0,n.revalidatePath)(`/product/${l.slug}`),{success:!0,message:`${l.name} added to cart`}}}catch(e){return{success:!1,message:(0,a.Wk)(e)}}}async function f(){let e=(await i.UL()).get("sessionCartId")?.value;if(!e)throw Error("Cart session not found");let t=await (0,o.j2)(),r=t?.user?.id?t.user.id:void 0,s=await d.z.cart.findFirst({where:r?{userId:r}:{sessionCartId:e}});if(s)return(0,a.W4)({...s,items:s.items,itemsPrice:s.itemsPrice.toString(),totalPrice:s.totalPrice.toString(),shippingPrice:s.shippingPrice.toString(),taxPrice:s.taxPrice.toString()})}async function m(e){try{if(!(await i.UL()).get("sessionCartId")?.value)throw Error("Cart session not found");let t=await d.z.product.findFirst({where:{id:e}});if(!t)throw Error("Product not found");let r=await f();if(!r)throw Error("Cart not found");let s=r.items.find(t=>t.productId===e);if(!s)throw Error("Item not found");return 1===s.qty?r.items=r.items.filter(e=>e.productId!=s.productId):r.items.find(t=>t.productId===e).qty=s.qty-1,await d.z.cart.update({where:{id:r.id},data:{items:r.items,...p(r.items)}}),(0,n.revalidatePath)(`/product/${t.slug}`),{success:!0,message:`${t.name} was removed from cart`}}catch(e){return{success:!1,message:(0,a.Wk)(e)}}}(0,u.D)([l,f,m]),(0,s.A)(l,"4071e420d37979b01d6488c32f7874c7e8b25f49a6",null),(0,s.A)(f,"0063481ceb220ca367b0bfd81f4b7e7bb8a5412c3c",null),(0,s.A)(m,"40d284a28645fa75db43c5e69c2454b9cbdf6b7927",null)},20402:(e,t,r)=>{"use strict";r.d(t,{f:()=>p,p:()=>l});var s=r(88977);r(98063);var i=r(23543),a=r(55946),o=r(67905),d=r(34296),c=r(67185),n=r(84976),u=r(21320);async function p(){try{let e=await (0,o.j2)();if(!e)throw Error("User is not authenticated");let t=await (0,d.P_)(),r=e?.user?.id;if(!r)throw Error("User not found");let s=await (0,c.kl)(r);if(!t||0===t.items.length)return{success:!1,message:"Your cart is empty",redirectTo:"/cart"};if(!s.address)return{success:!1,message:"No shipping address",redirectTo:"/shipping-address"};if(!s.paymentMethod)return{success:!1,message:"No payment method",redirectTo:"/payment-method"};let i=n.Lc.parse({userId:s.id,shippingAddress:s.address,paymentMethod:s.paymentMethod,itemsPrice:t.itemsPrice,shippingPrice:t.shippingPrice,taxPrice:t.taxPrice,totalPrice:t.totalPrice}),a=await u.z.$transaction(async e=>{let r=await e.order.create({data:i});for(let s of t.items)await e.orderItem.create({data:{...s,price:s.price,orderId:r.id}});return await e.cart.update({where:{id:t.id},data:{items:[],totalPrice:0,taxPrice:0,shippingPrice:0,itemsPrice:0}}),r.id});if(!a)throw Error("Order not created");return{success:!0,message:"Order created",redirectTo:`/order/${a}`}}catch(e){if((0,i.isRedirectError)(e))throw e;return{success:!1,message:(0,a.Wk)(e)}}}async function l(e){let t=await u.z.order.findFirst({where:{id:e},include:{orderitems:!0,user:{select:{name:!0,email:!0}}}});return(0,a.W4)(t)}(0,r(56215).D)([p,l]),(0,s.A)(p,"009354b2c685f8183e27b43b6c9ba079b5e5dfbd20",null),(0,s.A)(l,"40efcb2c47378c67bb23c7193b509b4fb00045e8c7",null)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,187,8,3,670,95,482,777,567],()=>r(69547));module.exports=s})();