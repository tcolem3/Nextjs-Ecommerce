(()=>{var e={};e.id=883,e.ids=[883],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},66541:e=>{"use strict";e.exports=require("@prisma/client/runtime/library")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},91645:e=>{"use strict";e.exports=require("net")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},34631:e=>{"use strict";e.exports=require("tls")},79551:e=>{"use strict";e.exports=require("url")},74075:e=>{"use strict";e.exports=require("zlib")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},69547:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>d.a,__next_app__:()=>u,pages:()=>l,routeModule:()=>p,tree:()=>n});var s=t(70260),a=t(28203),i=t(25155),d=t.n(i),o=t(67292),c={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);t.d(r,c);let n=["",{children:["(root)",{children:["order",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,77641)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\order\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,44751)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\layout.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,19611)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,82819)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,61129)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\order\\[id]\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(root)/order/[id]/page",pathname:"/order/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},19508:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"0041061ba5e3b6d0936cd61fbecddc17b8c23f81ed":()=>s.BP,"0063481ceb220ca367b0bfd81f4b7e7bb8a5412c3c":()=>i.P_,"009354b2c685f8183e27b43b6c9ba079b5e5dfbd20":()=>a.f,"4006037fbd5f93e00a275688371d306ee0c10f0e9c":()=>s.cE,"401c9b575412be014157debf32a1a1378158b2c6c3":()=>s.xu,"404125e7a6a2f0a516a9634afd9d946ea3ca503de9":()=>s.kl,"4071e420d37979b01d6488c32f7874c7e8b25f49a6":()=>i.Mr,"40d284a28645fa75db43c5e69c2454b9cbdf6b7927":()=>i.I1,"40efcb2c47378c67bb23c7193b509b4fb00045e8c7":()=>a.p,"60214fc46e351a83723c4e63b39e498fe69676b5ca":()=>s.VR,"6076f8d318fdf5837c18b232d3912ca52665d432e4":()=>s.Wd});var s=t(67185),a=t(20402),i=t(34296)},71737:(e,r,t)=>{Promise.resolve().then(t.bind(t,22936))},42361:(e,r,t)=>{Promise.resolve().then(t.bind(t,98115))},98115:(e,r,t)=>{"use strict";t.d(r,{default:()=>m});var s=t(45512);t(58009);var a=t(21643),i=t(59462);let d=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:r,...t}){return(0,s.jsx)("div",{className:(0,i.cn)(d({variant:r}),e),...t})}var c=t(97643),n=t(13393),l=t(28531),u=t.n(l),p=t(45103);let m=({order:e})=>{let{id:r,shippingAddress:t,orderitems:a,itemsPrice:d,shippingPrice:l,taxPrice:m,totalPrice:f,paymentMethod:x,isPaid:h,paidAt:b}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h1",{className:"py-4 text-2xl",children:["Order ",(0,i.hX)(r)]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 md:gap-5",children:[(0,s.jsxs)("div",{className:"col-span-2 space-4-y overlow-x-auto",children:[(0,s.jsx)(c.Zp,{children:(0,s.jsxs)(c.Wu,{className:"p-4 gap-4",children:[(0,s.jsx)("h2",{className:"text-xl pb-4",children:" Payment Method "}),(0,s.jsx)("p",{className:"mb-2",children:x}),h?(0,s.jsxs)(o,{variant:"secondary",children:["Paid at ",(0,i.r6)(b).dateTime]}):(0,s.jsx)(o,{variant:"destructive",children:"Not paid"})]})}),(0,s.jsx)(c.Zp,{className:"my-2",children:(0,s.jsxs)(c.Wu,{className:"p-4 gap-4",children:[(0,s.jsx)("h2",{className:"text-xl pb-4",children:" Shipping Address "}),(0,s.jsx)("p",{children:t.fullName}),(0,s.jsxs)("p",{className:"mb-2",children:[t.streetAddress,", ",t.city,", ",t.postalCode,", ",t.country]}),h?(0,s.jsxs)(o,{variant:"secondary",children:["Paid at ",(0,i.r6)(b).dateTime]}):(0,s.jsx)(o,{variant:"destructive",children:"Not paid"})]})}),(0,s.jsx)(c.Zp,{children:(0,s.jsxs)(c.Wu,{className:"p-4 gap-4",children:[(0,s.jsx)("h2",{className:"text-xl pb-4",children:"Order Items"}),(0,s.jsxs)(n.XI,{children:[(0,s.jsx)(n.A0,{children:(0,s.jsxs)(n.Hj,{children:[(0,s.jsx)(n.nd,{children:"Item"}),(0,s.jsx)(n.nd,{children:"Quantity"}),(0,s.jsx)(n.nd,{children:"Price"})]})}),(0,s.jsx)(n.BF,{children:a.map(e=>(0,s.jsxs)(n.Hj,{children:[(0,s.jsx)(n.nA,{children:(0,s.jsxs)(u(),{href:"/product/{item.slug}",className:"flex items-center",children:[(0,s.jsx)(p.default,{src:e.image,alt:e.name,width:50,height:50}),(0,s.jsx)("span",{className:"px-2",children:e.name})]})}),(0,s.jsx)(n.nA,{children:(0,s.jsx)("span",{className:"px-2",children:e.qty})}),(0,s.jsxs)(n.nA,{className:"text-right",children:["$",e.price]})]},e.slug))})]})]})})]}),(0,s.jsx)("div",{children:(0,s.jsx)(c.Zp,{children:(0,s.jsxs)(c.Wu,{className:"p-4 gap-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:"Item"}),(0,s.jsx)("div",{children:(0,i.vv)(d)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:"Tax"}),(0,s.jsx)("div",{children:(0,i.vv)(m)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:"Shipping"}),(0,s.jsx)("div",{children:(0,i.vv)(l)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("p",{children:"Total"}),(0,s.jsx)("div",{children:(0,i.vv)(f)})]})]})})})]})]})}},97643:(e,r,t)=>{"use strict";t.d(r,{Wu:()=>o,Zp:()=>d});var s=t(45512),a=t(58009),i=t(59462);let d=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));d.displayName="Card",a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r})).displayName="CardHeader",a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r})).displayName="CardTitle",a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...r})).displayName="CardDescription";let o=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...r}));o.displayName="CardContent",a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},13393:(e,r,t)=>{"use strict";t.d(r,{A0:()=>o,BF:()=>c,Hj:()=>n,XI:()=>d,nA:()=>u,nd:()=>l});var s=t(45512),a=t(58009),i=t(59462);let d=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",e),...r})}));d.displayName="Table";let o=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",e),...r}));o.displayName="TableHeader";let c=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",e),...r}));c.displayName="TableBody",a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...r})).displayName="TableFooter";let n=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...r}));n.displayName="TableRow";let l=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("th",{ref:t,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...r}));l.displayName="TableHead";let u=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("td",{ref:t,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...r}));u.displayName="TableCell",a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",e),...r})).displayName="TableCaption"},22936:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\colep\\\\Desktop\\\\git\\\\Nextjs-Ecommerce\\\\app\\\\(root)\\\\order\\\\[id]\\\\order-details-table.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\order\\[id]\\order-details-table.tsx","default")},77641:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c,metadata:()=>o});var s=t(62740),a=t(20402),i=t(31831),d=t(22936);let o={title:"Order Details"},c=async e=>{let{id:r}=await e.params,t=await (0,a.p)(r);return t||(0,i.notFound)(),(0,s.jsx)(d.default,{order:{...t,shippingAddress:t.shippingAddress}})}},34296:(e,r,t)=>{"use strict";t.d(r,{I1:()=>f,Mr:()=>p,P_:()=>m});var s=t(88977);t(98063);var a=t(44512),i=t(55946),d=t(67905),o=t(21320),c=t(84976),n=t(61482),l=t(56215);let u=e=>{let r=(0,i.X4)(e.reduce((e,r)=>e+Number(r.price)*r.qty,0)),t=(0,i.X4)(r>100?0:10),s=(0,i.X4)(.15*r),a=(0,i.X4)(r+s+t);return{itemsPrice:r.toFixed(2),shippingPrice:t.toFixed(2),taxPrice:s.toFixed(2),totalPrice:a.toFixed(2)}};async function p(e){try{let r=(await a.UL()).get("sessionCartId")?.value;if(!r)throw Error("Cart session not found");let t=await (0,d.j2)(),s=t?.user?.id?t.user.id:void 0,i=await m(),l=c.HS.parse(e),p=await o.z.product.findFirst({where:{id:l.productId}});if(!p)throw Error("Product not found");if(i){let e=i.items.find(e=>e.productId===l.productId);if(e){if(p.stock<e.qty+1)throw Error("Not enough stock");i.items.find(e=>e.productId===l.productId).qty=e.qty+1}else{if(p.stock<1)throw Error("Not enough stock");i.items.push(l)}return await o.z.cart.update({where:{id:i.id},data:{items:i.items,...u(i.items)}}),(0,n.revalidatePath)(`/product/${p.slug}`),{success:!0,message:`${p.name} ${e?"updated in":"added to"} cart`}}{let e=c.rZ.parse({userId:s,items:[l],sessionCartId:r,...u([l])});return await o.z.cart.create({data:e}),(0,n.revalidatePath)(`/product/${p.slug}`),{success:!0,message:`${p.name} added to cart`}}}catch(e){return{success:!1,message:(0,i.Wk)(e)}}}async function m(){let e=(await a.UL()).get("sessionCartId")?.value;if(!e)throw Error("Cart session not found");let r=await (0,d.j2)(),t=r?.user?.id?r.user.id:void 0,s=await o.z.cart.findFirst({where:t?{userId:t}:{sessionCartId:e}});if(s)return(0,i.W4)({...s,items:s.items,itemsPrice:s.itemsPrice.toString(),totalPrice:s.totalPrice.toString(),shippingPrice:s.shippingPrice.toString(),taxPrice:s.taxPrice.toString()})}async function f(e){try{if(!(await a.UL()).get("sessionCartId")?.value)throw Error("Cart session not found");let r=await o.z.product.findFirst({where:{id:e}});if(!r)throw Error("Product not found");let t=await m();if(!t)throw Error("Cart not found");let s=t.items.find(r=>r.productId===e);if(!s)throw Error("Item not found");return 1===s.qty?t.items=t.items.filter(e=>e.productId!=s.productId):t.items.find(r=>r.productId===e).qty=s.qty-1,await o.z.cart.update({where:{id:t.id},data:{items:t.items,...u(t.items)}}),(0,n.revalidatePath)(`/product/${r.slug}`),{success:!0,message:`${r.name} was removed from cart`}}catch(e){return{success:!1,message:(0,i.Wk)(e)}}}(0,l.D)([p,m,f]),(0,s.A)(p,"4071e420d37979b01d6488c32f7874c7e8b25f49a6",null),(0,s.A)(m,"0063481ceb220ca367b0bfd81f4b7e7bb8a5412c3c",null),(0,s.A)(f,"40d284a28645fa75db43c5e69c2454b9cbdf6b7927",null)},20402:(e,r,t)=>{"use strict";t.d(r,{f:()=>u,p:()=>p});var s=t(88977);t(98063);var a=t(23543),i=t(55946),d=t(67905),o=t(34296),c=t(67185),n=t(84976),l=t(21320);async function u(){try{let e=await (0,d.j2)();if(!e)throw Error("User is not authenticated");let r=await (0,o.P_)(),t=e?.user?.id;if(!t)throw Error("User not found");let s=await (0,c.kl)(t);if(!r||0===r.items.length)return{success:!1,message:"Your cart is empty",redirectTo:"/cart"};if(!s.address)return{success:!1,message:"No shipping address",redirectTo:"/shipping-address"};if(!s.paymentMethod)return{success:!1,message:"No payment method",redirectTo:"/payment-method"};let a=n.Lc.parse({userId:s.id,shippingAddress:s.address,paymentMethod:s.paymentMethod,itemsPrice:r.itemsPrice,shippingPrice:r.shippingPrice,taxPrice:r.taxPrice,totalPrice:r.totalPrice}),i=await l.z.$transaction(async e=>{let t=await e.order.create({data:a});for(let s of r.items)await e.orderItem.create({data:{...s,price:s.price,orderId:t.id}});return await e.cart.update({where:{id:r.id},data:{items:[],totalPrice:0,taxPrice:0,shippingPrice:0,itemsPrice:0}}),t.id});if(!i)throw Error("Order not created");return{success:!0,message:"Order created",redirectTo:`/order/${i}`}}catch(e){if((0,a.isRedirectError)(e))throw e;return{success:!1,message:(0,i.Wk)(e)}}}async function p(e){let r=await l.z.order.findFirst({where:{id:e},include:{orderitems:!0,user:{select:{name:!0,email:!0}}}});return(0,i.W4)(r)}(0,t(56215).D)([u,p]),(0,s.A)(u,"009354b2c685f8183e27b43b6c9ba079b5e5dfbd20",null),(0,s.A)(p,"40efcb2c47378c67bb23c7193b509b4fb00045e8c7",null)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,187,8,3,670,95,482,777,567],()=>t(69547));module.exports=s})();