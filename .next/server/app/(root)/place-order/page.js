(()=>{var e={};e.id=325,e.ids=[325],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},66541:e=>{"use strict";e.exports=require("@prisma/client/runtime/library")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},91645:e=>{"use strict";e.exports=require("net")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},34631:e=>{"use strict";e.exports=require("tls")},79551:e=>{"use strict";e.exports=require("url")},74075:e=>{"use strict";e.exports=require("zlib")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},59115:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>d.a,__next_app__:()=>p,pages:()=>l,routeModule:()=>u,tree:()=>n});var s=t(70260),a=t(28203),i=t(25155),d=t.n(i),o=t(67292),c={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);t.d(r,c);let n=["",{children:["(root)",{children:["place-order",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,97195)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\place-order\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,44751)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\layout.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,19611)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,82819)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,61129)),"C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["C:\\Users\\colep\\Desktop\\git\\Nextjs-Ecommerce\\app\\(root)\\place-order\\page.tsx"],p={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(root)/place-order/page",pathname:"/place-order",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},6466:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"0041061ba5e3b6d0936cd61fbecddc17b8c23f81ed":()=>s.BP,"0063481ceb220ca367b0bfd81f4b7e7bb8a5412c3c":()=>a.P_,"4006037fbd5f93e00a275688371d306ee0c10f0e9c":()=>s.cE,"401c9b575412be014157debf32a1a1378158b2c6c3":()=>s.xu,"404125e7a6a2f0a516a9634afd9d946ea3ca503de9":()=>s.kl,"4071e420d37979b01d6488c32f7874c7e8b25f49a6":()=>a.Mr,"40d284a28645fa75db43c5e69c2454b9cbdf6b7927":()=>a.I1,"60214fc46e351a83723c4e63b39e498fe69676b5ca":()=>s.VR,"6076f8d318fdf5837c18b232d3912ca52665d432e4":()=>s.Wd});var s=t(67185),a=t(34296)},41224:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,59607,23)),Promise.resolve().then(t.t.bind(t,71066,23))},28072:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,28531,23)),Promise.resolve().then(t.t.bind(t,41902,23))},97195:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>N,metadata:()=>y});var s=t(62740),a=t(67905),i=t(34296),d=t(67185),o=t(31831),c=t(22496),n=t(19935),l=t(59607),p=t.n(l),u=t(38537),m=t(76301),x=t(55946);let f=m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,x.cn)("w-full caption-bottom text-sm",e),...r})}));f.displayName="Table";let h=m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("thead",{ref:t,className:(0,x.cn)("[&_tr]:border-b",e),...r}));h.displayName="TableHeader";let b=m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("tbody",{ref:t,className:(0,x.cn)("[&_tr:last-child]:border-0",e),...r}));b.displayName="TableBody",m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("tfoot",{ref:t,className:(0,x.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...r})).displayName="TableFooter";let j=m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("tr",{ref:t,className:(0,x.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...r}));j.displayName="TableRow";let v=m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("th",{ref:t,className:(0,x.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...r}));v.displayName="TableHead";let g=m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("td",{ref:t,className:(0,x.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...r}));g.displayName="TableCell",m.forwardRef(({className:e,...r},t)=>(0,s.jsx)("caption",{ref:t,className:(0,x.cn)("mt-4 text-sm text-muted-foreground",e),...r})).displayName="TableCaption";var w=t(35635);let y={title:"Place Order"},N=async()=>{let e=await (0,i.P_)(),r=await (0,a.j2)(),t=r?.user?.id;if(!t)throw Error("User not found");let l=await (0,d.kl)(t);e&&0!==e.items.length||(0,o.redirect)("/cart"),l.address||(0,o.redirect)("/shipping-address"),l.paymentMethod||(0,o.redirect)("/payment-method");let m=l.address;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{current:3}),(0,s.jsx)("h1",{className:"py-4 text-2xl",children:"Place Order"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 md:gap-5",children:[(0,s.jsxs)("div",{className:"md:col-span-2 overflow-x-auto space-y-4",children:[(0,s.jsx)(n.Zp,{children:(0,s.jsxs)(n.Wu,{className:"p-4 gap-4",children:[(0,s.jsx)("h2",{className:"text-xl pb-4",children:"Shipping Address"}),(0,s.jsx)("p",{children:m.fullName}),(0,s.jsxs)("p",{children:[m.streetAddress,", ",m.city," "," "," ",m.postalCode,", ",m.country," "," "]}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(p(),{href:"/shipping-address",children:(0,s.jsx)(u.$,{variant:"outline",children:"Edit"})})})]})}),(0,s.jsx)(n.Zp,{children:(0,s.jsxs)(n.Wu,{className:"p-4 gap-4",children:[(0,s.jsx)("h2",{className:"text-xl pb-4",children:"Payment Method"}),(0,s.jsx)("p",{children:l.paymentMethod}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(p(),{href:"/payment-method",children:(0,s.jsx)(u.$,{variant:"outline",children:"Edit"})})})]})}),(0,s.jsx)(n.Zp,{children:(0,s.jsxs)(n.Wu,{className:"p-4 gap-4",children:[(0,s.jsx)("h2",{className:"text-xl pb-4",children:"Order Items"}),(0,s.jsxs)(f,{children:[(0,s.jsx)(h,{children:(0,s.jsxs)(j,{children:[(0,s.jsx)(v,{children:"Item"}),(0,s.jsx)(v,{children:"Quantity"}),(0,s.jsx)(v,{children:"Price"})]})}),(0,s.jsx)(b,{children:e.items.map(e=>(0,s.jsxs)(j,{children:[(0,s.jsx)(g,{children:(0,s.jsxs)(p(),{href:"/product/{item.slug}",className:"flex items-center",children:[(0,s.jsx)(w.default,{src:e.image,alt:e.name,width:50,height:50}),(0,s.jsx)("span",{className:"px-2",children:e.name})]})}),(0,s.jsx)(g,{children:(0,s.jsx)("span",{className:"px-2",children:e.qty})}),(0,s.jsx)(g,{className:"text-right",children:e.price})]},e.slug))})]})]})})]}),(0,s.jsx)("div",{children:(0,s.jsx)(n.Zp,{children:(0,s.jsxs)(n.Wu,{className:"p-4 gap-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:"Item"}),(0,s.jsx)("div",{children:(0,x.vv)(e.itemsPrice)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:"Tax"}),(0,s.jsx)("div",{children:(0,x.vv)(e.taxPrice)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:"Shipping"}),(0,s.jsx)("div",{children:(0,x.vv)(e.shippingPrice)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:"Total"}),(0,s.jsx)("div",{children:(0,x.vv)(e.totalPrice)})]})]})})})]})]})}},22496:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});var s=t(62740),a=t(76301),i=t.n(a),d=t(55946);let o=({current:e=0})=>(0,s.jsx)("div",{className:"flex-between flex-col md:flex-row space-x-2 space-y-2 mb-10",children:["User Login","Shipping Address","Payment Method","Place Order"].map((r,t)=>(0,s.jsxs)(i().Fragment,{children:[(0,s.jsx)("div",{className:(0,d.cn)("p-2 w-56 rounded-full text-center text-sm",t===e?"bg-secondary":""),children:r}),"Place Order"!==r&&(0,s.jsx)("hr",{className:"w-16 border-t border-gray-300 mx-2"})]},r))})},19935:(e,r,t)=>{"use strict";t.d(r,{BT:()=>n,Wu:()=>l,ZB:()=>c,Zp:()=>d,aR:()=>o});var s=t(62740),a=t(76301),i=t(55946);let d=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));d.displayName="Card";let o=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r}));o.displayName="CardHeader";let c=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));c.displayName="CardTitle";let n=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));n.displayName="CardDescription";let l=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...r}));l.displayName="CardContent",a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},34296:(e,r,t)=>{"use strict";t.d(r,{I1:()=>x,Mr:()=>u,P_:()=>m});var s=t(88977);t(98063);var a=t(44512),i=t(55946),d=t(67905),o=t(21320),c=t(84976),n=t(61482),l=t(56215);let p=e=>{let r=(0,i.X4)(e.reduce((e,r)=>e+Number(r.price)*r.qty,0)),t=(0,i.X4)(r>100?0:10),s=(0,i.X4)(.15*r),a=(0,i.X4)(r+s+t);return{itemsPrice:r.toFixed(2),shippingPrice:t.toFixed(2),taxPrice:s.toFixed(2),totalPrice:a.toFixed(2)}};async function u(e){try{let r=(await a.UL()).get("sessionCartId")?.value;if(!r)throw Error("Cart session not found");let t=await (0,d.j2)(),s=t?.user?.id?t.user.id:void 0,i=await m(),l=c.HS.parse(e),u=await o.z.product.findFirst({where:{id:l.productId}});if(!u)throw Error("Product not found");if(i){let e=i.items.find(e=>e.productId===l.productId);if(e){if(u.stock<e.qty+1)throw Error("Not enough stock");i.items.find(e=>e.productId===l.productId).qty=e.qty+1}else{if(u.stock<1)throw Error("Not enough stock");i.items.push(l)}return await o.z.cart.update({where:{id:i.id},data:{items:i.items,...p(i.items)}}),(0,n.revalidatePath)(`/product/${u.slug}`),{success:!0,message:`${u.name} ${e?"updated in":"added to"} cart`}}{let e=c.rZ.parse({userId:s,items:[l],sessionCartId:r,...p([l])});return await o.z.cart.create({data:e}),(0,n.revalidatePath)(`/product/${u.slug}`),{success:!0,message:`${u.name} added to cart`}}}catch(e){return{success:!1,message:(0,i.Wk)(e)}}}async function m(){let e=(await a.UL()).get("sessionCartId")?.value;if(!e)throw Error("Cart session not found");let r=await (0,d.j2)(),t=r?.user?.id?r.user.id:void 0,s=await o.z.cart.findFirst({where:t?{userId:t}:{sessionCartId:e}});if(s)return(0,i.W4)({...s,items:s.items,itemsPrice:s.itemsPrice.toString(),totalPrice:s.totalPrice.toString(),shippingPrice:s.shippingPrice.toString(),taxPrice:s.taxPrice.toString()})}async function x(e){try{if(!(await a.UL()).get("sessionCartId")?.value)throw Error("Cart session not found");let r=await o.z.product.findFirst({where:{id:e}});if(!r)throw Error("Product not found");let t=await m();if(!t)throw Error("Cart not found");let s=t.items.find(r=>r.productId===e);if(!s)throw Error("Item not found");return 1===s.qty?t.items=t.items.filter(e=>e.productId!=s.productId):t.items.find(r=>r.productId===e).qty=s.qty-1,await o.z.cart.update({where:{id:t.id},data:{items:t.items,...p(t.items)}}),(0,n.revalidatePath)(`/product/${r.slug}`),{success:!0,message:`${r.name} was removed from cart`}}catch(e){return{success:!1,message:(0,i.Wk)(e)}}}(0,l.D)([u,m,x]),(0,s.A)(u,"4071e420d37979b01d6488c32f7874c7e8b25f49a6",null),(0,s.A)(m,"0063481ceb220ca367b0bfd81f4b7e7bb8a5412c3c",null),(0,s.A)(x,"40d284a28645fa75db43c5e69c2454b9cbdf6b7927",null)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,187,8,3,670,95,482,777,567],()=>t(59115));module.exports=s})();